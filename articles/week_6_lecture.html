<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Forests of the Future Week 6 Lecture">
<title>Forests of the Future Week 6 Lecture • fofpack</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Forests of the Future Week 6 Lecture">
<meta property="og:description" content="Forests of the Future Week 6 Lecture">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fofpack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9010</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/week_10_lecture_1.html">Forests of the Future: Week 10 Lecture</a>
    <a class="dropdown-item" href="../articles/week_10_lecture_2.html">Forests of the Future: Week 10 Lecture Part 2</a>
    <a class="dropdown-item" href="../articles/week_5_lecture.html">Week 5 Lecture: Introduction to Species Distribution Modelling (SDM)</a>
    <a class="dropdown-item" href="../articles/week_6_lecture.html">Forests of the Future Week 6 Lecture</a>
    <a class="dropdown-item" href="../articles/week_7_lecture.html">Forests of the Future: Week 7 Lecture</a>
    <a class="dropdown-item" href="../articles/assignments.html">Forests of the Future: How to Complete and Submit Assignments</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Forests of the Future Week 6 Lecture</h1>
            
      
      
      <div class="d-none name"><code>week_6_lecture.Rmd</code></div>
    </div>

    
    
<style type="text/css">
@media print {
  .topicsContainer,
  .topicActions,
  .exerciseActions .skip {
    display: none;
  }
  .topics .tutorialTitle,
  .topics .section.level2,
  .topics .section.level3:not(.hide) {
    display: block;
  }
  .topics {
    width: 100%;
  }
  .tutorial-exercise, .tutorial-question {
    page-break-inside: avoid;
  }
  .section.level3.done h3 {
    padding-left: 0;
    background-image: none;
  }
  .topics .showSkip .exerciseActions::before {
    content: "Topic not yet completed...";
    font-style: italic;
  }
}
</style>
<div class="section level2">
<h2 id="forests-of-the-future-week-6">Forests of the Future Week 6<a class="anchor" aria-label="anchor" href="#forests-of-the-future-week-6"></a>
</h2>
<div class="section level3">
<h3 id="species-distribution-modelling-2">Species Distribution Modelling 2<a class="anchor" aria-label="anchor" href="#species-distribution-modelling-2"></a>
</h3>
<ul>
<li>Last week we learned how to use <code>tidymodels</code> to fit a
model to data</li>
<li>We modelled the abundance of fish species at different reefs based
on their mean temperatures</li>
<li>Today we will talk about modelling occurrence data, where we have
data on the presence or absence of species at particular sites</li>
<li>We will also learn how to preprocess data using
<code>tidymodels</code>, with the <code>recipes</code> package</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="ecological-niche-theory">Ecological Niche Theory<a class="anchor" aria-label="anchor" href="#ecological-niche-theory"></a>
</h2>
<ul>
<li>All species have an ecological niche</li>
<li>An Ecological niche is the position of a species within an ecosystem
<ul>
<li>The conditions necessary for persistence of the species</li>
<li>Its ecological role in the ecosystem</li>
</ul>
</li>
<li>Combining both more formally:
<ul>
<li>A niche is: the part of ecological space (defined by all
combinations of biotic and abiotic environmental conditions) where the
species population can persist and thus utilize resources and impact its
environment</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="ecological-niche-theory-1">Ecological Niche Theory<a class="anchor" aria-label="anchor" href="#ecological-niche-theory-1"></a>
</h2>
<ul>
<li>Niches are often visualized or conceptualized as hump-shaped
distributions along an environmental variable</li>
</ul>
<p><img src="images/A+single+niche+axis+e.g.,+pH,+temperature,+or+soil+moisture.jpg"></p>
</div>
<div class="section level2">
<h2 id="ecological-niche-theory-2">Ecological Niche Theory<a class="anchor" aria-label="anchor" href="#ecological-niche-theory-2"></a>
</h2>
<ul>
<li>Compare that with the model predictions I made in last lecture:</li>
</ul>
<p><img src="images/2022-09-23%2015_09_30-Week%205%20Lecture%20Introduction%20to%20Species%20Distribution%20Modelling%20(SDM).pdf%20-%20Work%20-.png"></p>
</div>
<div class="section level2">
<h2 id="generalise-to-many-dimensions">Generalise to many dimensions<a class="anchor" aria-label="anchor" href="#generalise-to-many-dimensions"></a>
</h2>
<ul>
<li>Environmental ‘hypervolume’</li>
</ul>
<div class="figure">
<img src="images/pnas_movies1.webp" alt=""><p class="caption">3D Hypervolume</p>
</div>
</div>
<div class="section level2">
<h2 id="review">Review<a class="anchor" aria-label="anchor" href="#review"></a>
</h2>
</div>
<div class="section level2">
<h2 id="data-science-steps">Data Science Steps<a class="anchor" aria-label="anchor" href="#data-science-steps"></a>
</h2>
<ol style="list-style-type: decimal">
<li><strong>A Question</strong></li>
<li><strong>Collect Data</strong></li>
<li><strong>Munge / Clean Data</strong></li>
<li><strong>Transform Data for Model</strong></li>
<li><strong>Analyze Data using Model</strong></li>
<li>Tune Model</li>
<li>Validate / Test Model</li>
<li>Interpret Model</li>
</ol>
</div>
<div class="section level2">
<h2 id="this-week">This week<a class="anchor" aria-label="anchor" href="#this-week"></a>
</h2>
<ol style="list-style-type: decimal">
<li>A Question</li>
<li>Collect Data</li>
<li>Munge / Clean Data</li>
<li><strong>Transform Data for Model</strong></li>
<li><strong>Analyze Data using Model</strong></li>
<li>Tune Model</li>
<li><strong>Validate / Test Model</strong></li>
<li>Interpret Model</li>
</ol>
<hr>
<ul>
<li>Modelling fish abundance</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"RF_abund"</span><span class="op">)</span></span>
<span><span class="va">fish_dat</span> <span class="op">&lt;-</span> <span class="va">RF_abund</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">SpeciesName</span> <span class="op">==</span> <span class="st">"Thalassoma pavo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Presence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Presence</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>What if we only had presence / absence data?</li>
</ul>
</div>
<div class="section level2">
<h2 id="presence-absence-data">Presence / Absence Data<a class="anchor" aria-label="anchor" href="#presence-absence-data"></a>
</h2>
<ul>
<li>We are not really modelling numeric data anymore</li>
<li>Presence or Absence are categories</li>
<li>We do a classification Model, and classify into the present or
absent category</li>
<li>Binary classification models typically output a ‘probability’, a
number between 0 and 1</li>
<li>Observed data is compared to output using the ‘binomial’ probability
distribution</li>
</ul>
</div>
<div class="section level2">
<h2 id="presence-absence-data-1">Presence / Absence Data<a class="anchor" aria-label="anchor" href="#presence-absence-data-1"></a>
</h2>
<ul>
<li>R has a number of probability distribution built-in which we can use
to explore</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   [1] 1 0 0 0 1 0 0 1 1 1 0 0 1 1 1 1 1 0 1 0 0 1 1 0 1 0 1 1 1 0 0 0 0 1 0 0 1</span></span>
<span><span class="co">##  [38] 1 0 1 0 0 0 1 1 1 1 1 1 0 0 1 1 0 0 0 1 0 0 1 0 0 0 0 0 1 1 1 0 0 1 1 0 1</span></span>
<span><span class="co">##  [75] 1 1 0 1 0 1 0 0 0 0 0 1 0 1 1 0 0 0 0 0 1 0 0 1 0 1</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   [1] 1 1 1 1 1 0 0 0 1 1 1 0 1 1 1 1 1 1 0 0 1 1 0 1 1 0 0 0 1 1 1 0 0 0 1 0 1</span></span>
<span><span class="co">##  [38] 0 1 1 1 1 1 0 1 1 0 1 0 1 0 1 1 1 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1</span></span>
<span><span class="co">##  [75] 1 0 0 1 1 1 1 1 0 1 1 1 0 1 1 1 1 0 1 1 1 0 1 1 1 0</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">0.25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   [1] 0 0 0 0 0 1 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 1 0 1 1 1 0 0 0 0 0 0 0 0 1</span></span>
<span><span class="co">##  [38] 1 0 0 0 0 0 0 1 1 1 0 1 0 1 1 0 0 0 0 0 1 0 0 0 1 0 0 1 0 0 1 0 0 0 0 1 0</span></span>
<span><span class="co">##  [75] 0 0 0 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="va">x</span>, size <span class="op">=</span> <span class="fl">100</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="week_6_lecture_files/figure-html/binomial-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="rf_abund-includes-presenceabsence-data-column">
<code>RF_abund</code> includes presence/absence data column<a class="anchor" aria-label="anchor" href="#rf_abund-includes-presenceabsence-data-column"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_dat</span><span class="op">$</span><span class="va">Presence</span></span></code></pre></div>
<pre><code><span><span class="co">##   [1] 1 1 1 1 1 1 0 1 1 1 0 1 1 1 1 1 0 1 1 1 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1 0</span></span>
<span><span class="co">##  [38] 1 1 1 1 1 1 0 0 0 1 1 0 1 0 0 1 1 1 0 1 1 0 1 0 0 1 1 1 0 0 0 0 0 0 1 1 1</span></span>
<span><span class="co">##  [75] 1 1 1 1 0 0 0 1 1 1 1 1 0 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">## [112] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">## [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">## [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 1 0 0 0 0 0 0 1 1 0 1 0 0 0 0 0 0 0</span></span>
<span><span class="co">## [223] 0 0 1 1 1 0 0 0 1 0 1 1 0 0 1 1 0 0 0 1 0 1 1 1 0 1 1 1 1 1 0 0 0 0 0 0 0</span></span>
<span><span class="co">## [260] 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 1</span></span>
<span><span class="co">## [297] 1 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 1 0 1 1 1 1 0 0 0 0 0 0 0</span></span>
<span><span class="co">## [334] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0</span></span>
<span><span class="co">## [371] 0 1 0 0 1 1 1 1 1 0 1 0 0 0 1</span></span>
<span><span class="co">## Levels: 0 1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="lets-model-fish-occurrence">Let’s model fish occurrence<a class="anchor" aria-label="anchor" href="#lets-model-fish-occurrence"></a>
</h2>
<ul>
<li>Use two variables: Mean Temperature and Depth</li>
<li>In order to make them more comparable we will ‘standardise’
them</li>
<li>We will also test our model by creating a test set</li>
</ul>
<hr>
<ul>
<li>Split off a test set:</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">data_split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">fish_dat</span>, <span class="fl">0.8</span>, strata <span class="op">=</span> <span class="va">Presence</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train_data</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 308 × 25</span></span></span>
<span><span class="co">##    SpeciesName   SiteC…¹ Abund…² Sampl…³ MeanT…⁴ MinTe…⁵ MaxTe…⁶ SDTem…⁷ ECOre…⁸</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Thalassoma p… AND2          0     164    17.6    14.1    22.8    2.85 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Thalassoma p… AND25         0     173    19.0    14.0    25.4    4.01 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Thalassoma p… AND37         0     173    19.1    14.0    26.1    4.20 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Thalassoma p… AND43         0     173    18.9    14.3    25.3    3.66 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Thalassoma p… AND50         0     164    18.2    14.2    23.5    3.02 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Thalassoma p… AND51         0     164    18.3    14.1    23.8    3.12 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Thalassoma p… AND54         0     173    18.6    14.2    24.6    3.41 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Thalassoma p… AND56         0     164    17.8    14.2    22.1    2.66 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Thalassoma p… AND60         0     164    18.4    14.9    22.2    2.53 Sahara…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Thalassoma p… AND63         0     173    18.9    14.4    26.3    3.85 Albora…</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 298 more rows, 16 more variables: Presence &lt;fct&gt;, OLRE &lt;fct&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   MaxAbundance &lt;dbl&gt;, N_Obs &lt;int&gt;, Confidence_NObs &lt;dbl&gt;, T_Range_Obs &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Confidence_TRange_Obs &lt;dbl&gt;, N_Absences_T_Upper &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N_Absences_T_Lower &lt;int&gt;, Confidence_Occ_Tupper &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Confidence_Occ_Tlower &lt;dbl&gt;, T_Upper_Absences &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   T_Lower_Absences &lt;dbl&gt;, T_Mean_Absences &lt;dbl&gt;, NEOLI &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Depth_Site &lt;dbl&gt;, and abbreviated variable names ¹​SiteCode, …</span></span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 77 × 25</span></span></span>
<span><span class="co">##    SpeciesName   SiteC…¹ Abund…² Sampl…³ MeanT…⁴ MinTe…⁵ MaxTe…⁶ SDTem…⁷ ECOre…⁸</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Thalassoma p… AND1          3     217    17.5    14.1    22.6    2.75 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Thalassoma p… AND12       100     173    18.5    14.0    24.7    3.67 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Thalassoma p… AND16         0     173    18.8    14.0    25.2    3.89 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Thalassoma p… AND18        13     173    18.9    14.0    25.2    3.92 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Thalassoma p… AND19         1     173    19.0    14.0    25.5    4.08 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Thalassoma p… AND21        11     173    18.8    14.0    25.2    3.87 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Thalassoma p… AND27        14     173    19.0    14.0    25.5    4.08 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Thalassoma p… AND29        17     173    19.0    14.0    25.4    4.03 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Thalassoma p… AND3          8     164    17.7    14.1    22.9    2.90 Albora…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Thalassoma p… AND4          0     164    17.9    14.1    23.3    3.01 Albora…</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 67 more rows, 16 more variables: Presence &lt;fct&gt;, OLRE &lt;fct&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   MaxAbundance &lt;dbl&gt;, N_Obs &lt;int&gt;, Confidence_NObs &lt;dbl&gt;, T_Range_Obs &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Confidence_TRange_Obs &lt;dbl&gt;, N_Absences_T_Upper &lt;int&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   N_Absences_T_Lower &lt;int&gt;, Confidence_Occ_Tupper &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Confidence_Occ_Tlower &lt;dbl&gt;, T_Upper_Absences &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   T_Lower_Absences &lt;dbl&gt;, T_Mean_Absences &lt;dbl&gt;, NEOLI &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Depth_Site &lt;dbl&gt;, and abbreviated variable names ¹​SiteCode, …</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="transform-data">Transform data<a class="anchor" aria-label="anchor" href="#transform-data"></a>
</h2>
<ul>
<li>Make symmetric and non-skewed (Yeo-Johnson transformation)</li>
<li>Flexible transformation that needs a parameter, which is usually
chosen based on an optimization with the training data</li>
<li>Standardise (make mean zero, and standard deviation 1)</li>
<li>Before:</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_dat</span> <span class="op">&lt;-</span> <span class="va">train_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">MeanTemp_CoralWatch</span>, <span class="va">Depth_Site</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, values_to <span class="op">=</span> <span class="st">"Value"</span>, names_to <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">s_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">Variable</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="week_6_lecture_files/figure-html/RF_plot-1.png" width="700"></p>
<hr>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MeanTemp_yj</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/powerTransform.html" class="external-link">powerTransform</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">$</span><span class="va">MeanTemp_CoralWatch</span>,</span>
<span>                                   family <span class="op">=</span> <span class="st">"yjPower"</span><span class="op">)</span></span>
<span><span class="va">Depth_yj</span> <span class="op">&lt;-</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/powerTransform.html" class="external-link">powerTransform</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">$</span><span class="va">Depth_Site</span>,</span>
<span>                                family <span class="op">=</span> <span class="st">"yjPower"</span><span class="op">)</span></span>
<span><span class="va">MeanTemp_yj</span></span></code></pre></div>
<pre><code><span><span class="co">## Estimated transformation parameter </span></span>
<span><span class="co">## train_data$MeanTemp_CoralWatch </span></span>
<span><span class="co">##                     -0.8426166</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Depth_yj</span></span></code></pre></div>
<pre><code><span><span class="co">## Estimated transformation parameter </span></span>
<span><span class="co">## train_data$Depth_Site </span></span>
<span><span class="co">##             0.1361994</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">train_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>MeanTemp_tr <span class="op">=</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/bcPower.html" class="external-link">yjPower</a></span><span class="op">(</span><span class="va">MeanTemp_CoralWatch</span>, <span class="va">MeanTemp_yj</span><span class="op">$</span><span class="va">roundlam</span><span class="op">)</span>,</span>
<span>         Depth_tr <span class="op">=</span> <span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/bcPower.html" class="external-link">yjPower</a></span><span class="op">(</span><span class="va">Depth_Site</span>, <span class="va">Depth_yj</span><span class="op">$</span><span class="va">roundlam</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<hr>
<ul>
<li>After:</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_dat</span> <span class="op">&lt;-</span> <span class="va">train_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">MeanTemp_tr</span>, <span class="va">Depth_tr</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, values_to <span class="op">=</span> <span class="st">"Value"</span>, names_to <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">s_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">Variable</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="week_6_lecture_files/figure-html/RF_plot2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="what-about-the-test-data">What about the test data?<a class="anchor" aria-label="anchor" href="#what-about-the-test-data"></a>
</h2>
<ul>
<li>When we use the model to predict the occurrence on the test set, the
data must be transformed in exactly the same way as the training
set</li>
<li>This means we need to keep our lambda parameter fit on the training
data and apply the same parameter to transform the test data</li>
<li>The standardisation also requires parameters from the training
data</li>
<li>Keeping track of these transformations manually is dangerous</li>
<li>A common mistake is to transform the test data using parameters
derived from the test data, this makes the test data incomparable to the
training data</li>
</ul>
</div>
<div class="section level2">
<h2 id="recipes-helps-to-solve-this-issue">Recipes helps to solve this issue<a class="anchor" aria-label="anchor" href="#recipes-helps-to-solve-this-issue"></a>
</h2>
<ul>
<li>A <code>recipe</code> is a set of steps applied to data before
modelling</li>
<li>Everything is kept track of by <code>tidymodels</code> so that the
steps are applied correctly to test data after the model is fit</li>
<li>Let’s make a recipe</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_recipe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">train_data</span>,</span>
<span>                    <span class="va">Presence</span> <span class="op">~</span> <span class="va">MeanTemp_CoralWatch</span> <span class="op">+</span> <span class="va">Depth_Site</span><span class="op">)</span></span>
<span><span class="va">RF_recipe</span></span></code></pre></div>
<pre><code><span><span class="co">## Recipe</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Inputs:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       role #variables</span></span>
<span><span class="co">##    outcome          1</span></span>
<span><span class="co">##  predictor          2</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="add-steps-to-the-recipe">Add Steps to the <code>recipe</code><a class="anchor" aria-label="anchor" href="#add-steps-to-the-recipe"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_recipe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">train_data</span>,</span>
<span>                    <span class="va">Presence</span> <span class="op">~</span> <span class="va">MeanTemp_CoralWatch</span> <span class="op">+</span> <span class="va">Depth_Site</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_YeoJohnson.html" class="external-link">step_YeoJohnson</a></span><span class="op">(</span><span class="va">MeanTemp_CoralWatch</span>, <span class="va">Depth_Site</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_normalize.html" class="external-link">step_normalize</a></span><span class="op">(</span><span class="va">MeanTemp_CoralWatch</span>, <span class="va">Depth_Site</span><span class="op">)</span></span>
<span><span class="va">RF_recipe</span></span></code></pre></div>
<pre><code><span><span class="co">## Recipe</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Inputs:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       role #variables</span></span>
<span><span class="co">##    outcome          1</span></span>
<span><span class="co">##  predictor          2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Operations:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Yeo-Johnson transformation on MeanTemp_CoralWatch, Depth_Site</span></span>
<span><span class="co">## Centering and scaling for MeanTemp_CoralWatch, Depth_Site</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="prep-the-recipe">Prep the <code>recipe</code><a class="anchor" aria-label="anchor" href="#prep-the-recipe"></a>
</h2>
<ul>
<li>Prepping a recipe estimates any required parameters</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_recipe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">RF_recipe</span><span class="op">)</span></span>
<span><span class="va">RF_recipe</span></span></code></pre></div>
<pre><code><span><span class="co">## Recipe</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Inputs:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       role #variables</span></span>
<span><span class="co">##    outcome          1</span></span>
<span><span class="co">##  predictor          2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Training data contained 308 data points and no missing data.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Operations:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Yeo-Johnson transformation on MeanTemp_CoralWatch, Depth_Site [trained]</span></span>
<span><span class="co">## Centering and scaling for MeanTemp_CoralWatch, Depth_Site [trained]</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="bake-the-recipe">Bake the <code>recipe</code><a class="anchor" aria-label="anchor" href="#bake-the-recipe"></a>
</h2>
<ul>
<li>Baking applies the steps to a dataset</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train_data_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">RF_recipe</span>, <span class="va">train_data</span><span class="op">)</span></span>
<span><span class="va">train_data_tr</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 308 × 3</span></span></span>
<span><span class="co">##    MeanTemp_CoralWatch Depth_Site Presence</span></span>
<span><span class="co">##                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>             -<span style="color: #BB0000;">0.761</span>     -<span style="color: #BB0000;">1.37</span>   0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>             -<span style="color: #BB0000;">0.125</span>     -<span style="color: #BB0000;">2.22</span>   0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>             -<span style="color: #BB0000;">0.070</span><span style="color: #BB0000; text-decoration: underline;">7</span>     0.555  0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>             -<span style="color: #BB0000;">0.150</span>     -<span style="color: #BB0000;">1.34</span>   0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>             -<span style="color: #BB0000;">0.480</span>     -<span style="color: #BB0000;">1.73</span>   0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>             -<span style="color: #BB0000;">0.448</span>     -<span style="color: #BB0000;">0.645</span>  0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>             -<span style="color: #BB0000;">0.300</span>     -<span style="color: #BB0000;">0.946</span>  0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>             -<span style="color: #BB0000;">0.672</span>      0.144  0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>             -<span style="color: #BB0000;">0.369</span>     -<span style="color: #BB0000;">0.196</span>  0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>             -<span style="color: #BB0000;">0.159</span>     -<span style="color: #BB0000;">0.048</span><span style="color: #BB0000; text-decoration: underline;">2</span> 0       </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 298 more rows</span></span></span></code></pre>
<hr>
<p>The data now looks like:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_dat</span> <span class="op">&lt;-</span> <span class="va">train_data_tr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">MeanTemp_CoralWatch</span>, <span class="va">Depth_Site</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>, values_to <span class="op">=</span> <span class="st">"Value"</span>, names_to <span class="op">=</span> <span class="st">"Variable"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">s_dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">Variable</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="week_6_lecture_files/figure-html/RF_plot3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="bake-the-test-data">Bake the test data<a class="anchor" aria-label="anchor" href="#bake-the-test-data"></a>
</h2>
<ul>
<li>We can now easily apply the exact same data manipulation to the test
data</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_data_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">RF_recipe</span>, <span class="va">test_data</span><span class="op">)</span></span>
<span><span class="va">test_data_tr</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 77 × 3</span></span></span>
<span><span class="co">##    MeanTemp_CoralWatch Depth_Site Presence</span></span>
<span><span class="co">##                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>             -<span style="color: #BB0000;">0.828</span>    -<span style="color: #BB0000;">2.00</span>    1       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>             -<span style="color: #BB0000;">0.315</span>     0.005<span style="text-decoration: underline;">43</span> 1       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>             -<span style="color: #BB0000;">0.177</span>    -<span style="color: #BB0000;">0.412</span>   0       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>             -<span style="color: #BB0000;">0.171</span>     0.495   1       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>             -<span style="color: #BB0000;">0.097</span><span style="color: #BB0000; text-decoration: underline;">2</span>   -<span style="color: #BB0000;">2.00</span>    1       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>             -<span style="color: #BB0000;">0.185</span>    -<span style="color: #BB0000;">0.667</span>   1       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>             -<span style="color: #BB0000;">0.098</span><span style="color: #BB0000; text-decoration: underline;">0</span>   -<span style="color: #BB0000;">1.93</span>    1       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>             -<span style="color: #BB0000;">0.119</span>     0.178   1       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>             -<span style="color: #BB0000;">0.710</span>    -<span style="color: #BB0000;">3.14</span>    1       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>             -<span style="color: #BB0000;">0.637</span>    -<span style="color: #BB0000;">2.64</span>    0       </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 67 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="combine-a-recipe-and-a-model">Combine a <code>recipe</code> and a <code>model</code><a class="anchor" aria-label="anchor" href="#combine-a-recipe-and-a-model"></a>
</h2>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_mod</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://parsnip.tidymodels.org/reference/boost_tree.html" class="external-link">boost_tree</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">'xgboost'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_args.html" class="external-link">set_mode</a></span><span class="op">(</span><span class="st">'classification'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">RF_mod</span></span></code></pre></div>
<pre><code><span><span class="co">## Boosted Tree Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: xgboost</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="a-workflow-is-a-recipe-and-a-model">A <code>workflow</code> is a <code>recipe</code> and a
<code>model</code><a class="anchor" aria-label="anchor" href="#a-workflow-is-a-recipe-and-a-model"></a>
</h2>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_wf</span> <span class="op">&lt;-</span> <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">RF_recipe</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">RF_mod</span><span class="op">)</span></span>
<span></span>
<span><span class="va">RF_wf</span></span></code></pre></div>
<pre><code><span><span class="co">## ══ Workflow ════════════════════════════════════════════════════════════════════</span></span>
<span><span class="co">## <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">## <span style="font-style: italic;">Model:</span> boost_tree()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Preprocessor ────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## 2 Recipe Steps</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • step_YeoJohnson()</span></span>
<span><span class="co">## • step_normalize()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Model ───────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## Boosted Tree Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: xgboost</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="use-fit-to-run-a-workflow">Use <code>fit</code> to run a workflow<a class="anchor" aria-label="anchor" href="#use-fit-to-run-a-workflow"></a>
</h2>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_fit</span> <span class="op">&lt;-</span> <span class="va">RF_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">train_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">RF_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## ══ Workflow [trained] ══════════════════════════════════════════════════════════</span></span>
<span><span class="co">## <span style="font-style: italic;">Preprocessor:</span> Recipe</span></span>
<span><span class="co">## <span style="font-style: italic;">Model:</span> boost_tree()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Preprocessor ────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## 2 Recipe Steps</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## • step_YeoJohnson()</span></span>
<span><span class="co">## • step_normalize()</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## ── Model ───────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">## ##### xgb.Booster</span></span>
<span><span class="co">## raw: 25.1 Kb </span></span>
<span><span class="co">## call:</span></span>
<span><span class="co">##   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span></span>
<span><span class="co">##     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span></span>
<span><span class="co">##     subsample = 1), data = x$data, nrounds = 15, watchlist = x$watchlist, </span></span>
<span><span class="co">##     verbose = 0, nthread = 1, objective = "binary:logistic")</span></span>
<span><span class="co">## params (as set within xgb.train):</span></span>
<span><span class="co">##   eta = "0.3", max_depth = "6", gamma = "0", colsample_bytree = "1", colsample_bynode = "1", min_child_weight = "1", subsample = "1", nthread = "1", objective = "binary:logistic", validate_parameters = "TRUE"</span></span>
<span><span class="co">## xgb.attributes:</span></span>
<span><span class="co">##   niter</span></span>
<span><span class="co">## callbacks:</span></span>
<span><span class="co">##   cb.evaluation.log()</span></span>
<span><span class="co">## # of features: 2 </span></span>
<span><span class="co">## niter: 15</span></span>
<span><span class="co">## nfeatures : 2 </span></span>
<span><span class="co">## evaluation_log:</span></span>
<span><span class="co">##     iter training_logloss</span></span>
<span><span class="co">##        1        0.5244973</span></span>
<span><span class="co">##        2        0.4279284</span></span>
<span><span class="co">## ---                      </span></span>
<span><span class="co">##       14        0.1878803</span></span>
<span><span class="co">##       15        0.1829834</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="make-predictions">Make predictions<a class="anchor" aria-label="anchor" href="#make-predictions"></a>
</h2>
<ul>
<li>Predict the test data</li>
<li>The workflow knows to apply the recipe to the test data first</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">RF_fit</span>, <span class="va">test_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 77 × 1</span></span></span>
<span><span class="co">##    .pred_class</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 0          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 1          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 1          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 1          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 1          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 1          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 1          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 1          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 0          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 0          </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 67 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">RF_fit</span>, <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 77 × 2</span></span></span>
<span><span class="co">##    .pred_0 .pred_1</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>  0.916   0.084<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>  0.110   0.890 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>  0.118   0.882 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>  0.065<span style="text-decoration: underline;">4</span>  0.935 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>  0.224   0.776 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>  0.080<span style="text-decoration: underline;">7</span>  0.919 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>  0.224   0.776 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>  0.136   0.864 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>  0.879   0.121 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>  0.767   0.233 </span></span>
<span><span class="co">## <span style="color: #949494;"># … with 67 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="augment-data-with-predictions">Augment data with predictions<a class="anchor" aria-label="anchor" href="#augment-data-with-predictions"></a>
</h2>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_test_preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">RF_fit</span>, <span class="va">test_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="at-last-we-test-the-fit-based-on-test-data">At last we test the fit based on test data<a class="anchor" aria-label="anchor" href="#at-last-we-test-the-fit-based-on-test-data"></a>
</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_test_preds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">roc_curve</span><span class="op">(</span><span class="va">.pred_0</span>, truth <span class="op">=</span> <span class="va">Presence</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="week_6_lecture_files/figure-html/wf7-1.png" width="700"></p>
<hr>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RF_test_preds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">roc_auc</span><span class="op">(</span><span class="va">.pred_0</span>, truth <span class="op">=</span> <span class="va">Presence</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   .metric .estimator .estimate</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> roc_auc binary         0.911</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plot-predictions-and-original-data">Plot predictions and original data<a class="anchor" aria-label="anchor" href="#plot-predictions-and-original-data"></a>
</h2>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/cross.html" class="external-link">cross_df</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>MeanTemp_CoralWatch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fish_dat</span><span class="op">$</span><span class="va">MeanTemp_CoralWatch</span><span class="op">)</span>,</span>
<span>                                                    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fish_dat</span><span class="op">$</span><span class="va">MeanTemp_CoralWatch</span><span class="op">)</span>,</span>
<span>                                                    length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                            Depth_Site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">fish_dat</span><span class="op">$</span><span class="va">Depth_Site</span><span class="op">)</span>,</span>
<span>                                             <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fish_dat</span><span class="op">$</span><span class="va">Depth_Site</span><span class="op">)</span>,</span>
<span>                                             length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">newdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span><span class="va">RF_fit</span>, <span class="va">pred_dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">newdat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">MeanTemp_CoralWatch</span>, <span class="va">Depth_Site</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">geom_contour_filled</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">.pred_1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">Presence</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">fish_dat</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using size for a discrete variable is not advised.</span></span></code></pre>
<p><img src="week_6_lecture_files/figure-html/b3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="pine-rocklands-plant-species">Pine Rocklands Plant Species<a class="anchor" aria-label="anchor" href="#pine-rocklands-plant-species"></a>
</h2>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"IRC"</span><span class="op">)</span></span>
<span><span class="va">IRC</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 476,255 × 7</span></span></span>
<span><span class="co">##    ScientificName         area_name            Occur…¹ Intro…² size   long   lat</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Abelmoschus esculentus A.D. Doug Barnes Pa… Absent  Not in… 60.4… -<span style="color: #BB0000;">80.3</span>  25.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Abelmoschus esculentus Alice C. Wainwright… Absent  Not in… 21.5… -<span style="color: #BB0000;">80.2</span>  25.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Abelmoschus esculentus Allapattah Flats Wi… Absent  Not in… 2094… -<span style="color: #BB0000;">80.5</span>  27.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Abelmoschus esculentus Amberjack Slough     Absent  Not in… 182 … -<span style="color: #BB0000;">82.3</span>  26.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Abelmoschus esculentus Arch Creek Park      Absent  Not in… 10.3… -<span style="color: #BB0000;">80.2</span>  25.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Abelmoschus esculentus Arthur R. Marshall … Absent  Not in… 1484… -<span style="color: #BB0000;">80.2</span>  26.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Abelmoschus esculentus Bahia Honda State P… Absent  Not in… 491.… -<span style="color: #BB0000;">81.3</span>  24.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Abelmoschus esculentus Bartlett Estate      Absent  Not in… 35 a… -<span style="color: #BB0000;">80.1</span>  26.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Abelmoschus esculentus Beachwalk Pasley Pa… Absent  Not in… 17 a… -<span style="color: #BB0000;">80.2</span>  27.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Abelmoschus esculentus Big and Little Geor… Absent  Not in… 18.2… -<span style="color: #BB0000;">80.4</span>  25.6</span></span>
<span><span class="co">## <span style="color: #949494;"># … with 476,245 more rows, and abbreviated variable names ¹​Occurrence,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ²​Introduced</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">IRC</span><span class="op">$</span><span class="va">area_name</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 205</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">IRC</span><span class="op">$</span><span class="va">ScientificName</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2323</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="species-summary">Species Summary<a class="anchor" aria-label="anchor" href="#species-summary"></a>
</h2>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">IRC_summ</span> <span class="op">&lt;-</span> <span class="va">IRC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Occurrence</span> <span class="op">==</span> <span class="st">"Present"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ScientificName</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>num_areas <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">area_name</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">num_areas</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>spec_num <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">IRC_summ</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">spec_num</span>, <span class="va">num_areas</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="week_6_lecture_files/figure-html/specs2-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Russell Dinnage.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
